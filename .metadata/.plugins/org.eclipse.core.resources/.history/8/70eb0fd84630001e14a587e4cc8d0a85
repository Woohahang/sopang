<%@ page language="java" contentType="text/html; charset=utf-8"
	pageEncoding="utf-8" isELIgnored="false"%>
<%@ taglib uri="http://tiles.apache.org/tags-tiles" prefix="tiles"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions"%>
<c:set var="contextPath" value="${pageContext.request.contextPath}" />
<c:set var="goods" value="${goodsMap.goodsVO}" />
<c:set var="imageList" value="${goodsMap.imageList }" />






<script type="text/javascript">

	//장바구니 추가, goods_id정보를 넘겨줌.
	function add_cart(goods_id) {
		$.ajax({
			type : "post",
			async : false,
			url : "${contextPath}/cart/addGoodsInCart.do",
			data : {goods_id:goods_id},
			success : function(data, textStatus) {
				if(data.trim()=='add_success'){alert("장바구니에 추가되엇습니다.");
				}else if(data.trim()=='already_existed'){alert("이미 카트에 등록된 상품입니다.");	}
			},
			error : function(data, textStatus) {alert("로그인 후 추가하실 수 있습니다!");},
			complete : function(data, textStatus) {}
		});
	}

	
//바로 주문하기 
function fn_order_each_goods(goods_id,goods_title,goods_sales_price,fileName){
	 	var total_price,final_total_price;
		var order_goods_qty=document.getElementById("order_goods_qty");
		var formObj=document.createElement("form");
		var i_goods_id = document.createElement("input"); 
	    var i_goods_title = document.createElement("input");
	    var i_goods_sales_price=document.createElement("input");
	    var i_fileName=document.createElement("input");
	    var i_order_goods_qty=document.createElement("input");
	    
		let memberName = "${memberInfo.member_name }";
		/* console.log(memberName); */
		 
		if(memberName == ""){alert("로그인 후 구매하실 수 있습니다!");}/* 로그인상태가 아닌경우 안내함. */
		else{
		    i_goods_id.name="goods_id";
		    i_goods_title.name="goods_title";
		    i_goods_sales_price.name="goods_sales_price";
		    i_fileName.name="goods_fileName";
		    i_order_goods_qty.name="order_goods_qty";
		    i_goods_id.value=goods_id;
		    i_order_goods_qty.value=1;//i_order_goods_qty 1로 고정
		    i_goods_title.value=goods_title;
		    i_goods_sales_price.value=goods_sales_price;
		    i_fileName.value=fileName;
		    
		    //formObj에 해당 상품 정보를 할당해 orderEachGoods로 action
		    formObj.appendChild(i_goods_id);
		    formObj.appendChild(i_goods_title);
		    formObj.appendChild(i_goods_sales_price);
		    formObj.appendChild(i_fileName);
		    formObj.appendChild(i_order_goods_qty);
		    document.body.appendChild(formObj); 
		    
		    formObj.method="post";
		    formObj.action="${contextPath}/order/orderEachGoods.do";
		    formObj.submit();
			}	
		
	}
	
</script>
